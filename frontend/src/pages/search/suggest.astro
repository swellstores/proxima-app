---
import { Swell } from '@swell/apps-sdk';
import { PredictiveSearchResource } from '@/resources/search';
import { handleServerRequest } from '@/utils/server';
import ThemePage from '@/components/ThemePage.astro';

export async function getData(swell: Swell, query: string | null) {
  return {
    predictive_search: new PredictiveSearchResource(swell, query),
  };
}

export const getJSON = handleServerRequest(async ({ swell, context }) => {
  return getData(swell, context.url.searchParams.get('q'));
});
---

<ThemePage
  id="search"
  getData={(swell) => getData(swell, Astro.url.searchParams.get('q'))}
/>
