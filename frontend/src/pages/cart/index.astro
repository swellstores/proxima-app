---
import { CartResource } from '@/resources';
import { handleServerRequest } from '@/utils/server';
import ThemePage from '@/components/ThemePage.astro';
import { parseResources } from '@/utils/server-resources';

import type { AstroGlobal } from 'astro';
import type { Swell } from '@swell/apps-sdk';

export async function getData(swell: Swell, Astro?: AstroGlobal) {
  return {
    cart: new CartResource(swell),
  };
}

export const getJSON = handleServerRequest(async ({ swell, context }) => {
  const data = await getData(swell);
  return parseResources(data);
});
---

<ThemePage id="cart" getData={(swell: Swell) => getData(swell, Astro)} />
