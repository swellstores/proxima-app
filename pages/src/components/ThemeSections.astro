---
import { SwellTheme } from '@swell/storefrontjs';

interface Props {
  theme: SwellTheme;
  content: ThemeSectionGroup;
  data: SwellData;
}

type AllowedTags =
  | 'article'
  | 'aside'
  | 'div'
  | 'footer'
  | 'header'
  | 'section';

interface Section {
  section: {
    type?: string;
  };
  output: string;
  tag: AllowedTags;
  attributes?: Record<string, string>;
}

const { theme, content, data } = Astro.props;
const sections = (await theme.renderPageSections(content, data)) as Section[];
---

{
  sections.map(({ section, output, tag: Tag, attributes }: Section) => {
    const { type = 'unknown' } = section;
    const TagComponent = Tag as keyof JSX.IntrinsicElements;
    return (
      <TagComponent
        data-swell-section={type}
        set:html={output}
        {...attributes}
      />
    );
  })
}
