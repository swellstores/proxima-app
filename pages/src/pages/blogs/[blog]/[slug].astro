---
import { SwellStorefrontRecord, StorefrontResource } from '../../../swell/api';
import ThemePage from '../../../components/ThemePage.astro';

const { blog: blogSlug, slug } = Astro.params;
---

<ThemePage
  id="blogs/blog"
  required="blog.id"
  title="{{ post.meta_title | default: post.title | default: post.name }}"
  description="{{ post.meta_description | default: post.description }}"
  getData={async (swell: Swell, theme: SwellTheme) => {
    const blog = new SwellStorefrontRecord(
      swell,
      `content/blogs`,
      blogSlug,
      theme.page?.query
    );

    const post = new StorefrontResource(() => {
      return swell.get('/content/blogs/' + blogSlug + '/posts/' + slug);
    });

    return {
      blog,
      post,
    };
  }}
/>
